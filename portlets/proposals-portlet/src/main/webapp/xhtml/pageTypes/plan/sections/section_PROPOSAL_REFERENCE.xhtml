<f:view 
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:collab="http://climatecollaboratorium.org/facelets"
    xmlns:ice="http://www.icesoft.com/icefaces/component"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:addthis="http://www.addthis.com/help/api-spec" >
    <f:subview rendered="#{empty section.referencedPlan}">
		Proposal not set yet.
	</f:subview>
	<f:subview rendered="#{not empty section.referencedPlan}">
		<collab:planLink planId="#{section.referencedPlan.planId}" contestId="#{section.referencedPlan.contestPK}" 
				text="#{section.referencedPlan.name}" />
	</f:subview>
	<ice:form>
		<div style="position: fixed; width: 100%; height: 100%; top: 0; left: 0; z-index: 100;" class="selectReferencedProposalPopup" >
		<div class="popup-wrap p1" id="invalidFieldsPopup">
 			<div class="popup">
 			
  				<h4>Choose proposal:</h4>
				<div class="prop-tabs" >
						<ul style="float: left;">
							<li class="#{section.proposalsFilterTab == 'MY_SUBSCRIPTIONS' ? 'c' : '' }">
								<ice:commandLink actionListener="#{section.changeProposalsFilterTab}" value="My subscriptions">
									<f:attribute name="tab" value="MY_SUBSCRIPTIONS" />
								</ice:commandLink>
							</li>
							<li class="#{section.proposalsFilterTab == 'SUPPORTING' ? 'c' : '' }">
								<ice:commandLink actionListener="#{section.changeProposalsFilterTab}" value="Supporting">
									<f:attribute name="tab" value="SUPPORTING" />
								</ice:commandLink>
							</li>
							<li class="#{section.proposalsFilterTab == 'ALL_PROPOSALS' ? 'c' : '' }">
								<ice:commandLink actionListener="#{section.changeProposalsFilterTab}" value="All proposals">
									<f:attribute name="tab" value="ALL_PROPOSALS" />
								</ice:commandLink>
							</li>
						</ul>
						<div class="filter">
							<ice:inputText type="text" placeholder="Filter proposals" styleClass="filterProposalsBox" value="#{section.proposalsFilter}" partialSubmit="true" />
						</div>
				</div>
				<div class="availableProposalsTableContainer">
				<ice:dataTable value="#{section.proposalsInScope}" var="item" headerClasses="contest proposal extra action" columnClasses="contest proposal extra action"
					sortColumn="#{section.proposalsFilterSortColumn}" sortAscending="#{section.proposalsFilterSortOrder}" >
					<ice:column>
						<f:facet name="header">
							<ice:commandSortHeader columnName="CONTEST" arrow="true">
 		                		<ice:outputText  value="Contest"/>
 		                	</ice:commandSortHeader>
						</f:facet>
						#{item.contestName}
					</ice:column>
					<ice:column>
						<f:facet name="header">Proposal</f:facet>
						#{item.name}
					</ice:column>
					<ice:column>
						<f:facet name="header">Date subscribed</f:facet>	
						#{item.subscribedDate}
					</ice:column>
					<ice:column>
						<f:facet name="header"> <ice:outputText value=" " /> </f:facet>
						<ice:commandLink value="Choose" >
							<f:attribute name="planId" value="#{item.planId}" />
						</ice:commandLink>
					</ice:column>
				
				</ice:dataTable>
				</div>
				
  				<div class="btns">
   					<div class="blue-button"><a href="javascript:;" onclick="jQuery('#invalidFieldsPopupContainer').fadeOut('fast')" class="cp1-1">CLOSE</a></div>
  				</div>
 			</div>
		</div>
	</div>
	</ice:form>
	<style type="text/css">


.availableProposalsTableContainer thead tr {
	position: relative;
	display: block;
}

.availableProposalsTableContainer table tbody {
	display: block;
	height: 240px;
	overflow-x: hidden;
	overflow-y: auto;
	width: 100%;
}

.selectReferencedProposalPopup .popup-wrap {
	top: 50px;
	width: 700px;
	
}

.selectReferencedProposalPopup .popup {
	height: 400px;
	
}

.availableProposalsTableContainer {
	height: 280px;
}

.availableProposalsTableContainer table {
	height: 280px;
	overflow-x: scroll;
	overflow-y: hidden;
	width: 640px;
}

.availableProposalsTableContainer table th {
	background: #e0e0e0;
	padding: 5px;
}

.availableProposalsTableContainer table td {
	padding: 5px;
}

.availableProposalsTableContainer table tr.portlet-section-alternate {
	background: #fafafa;
}
.availableProposalsTableContainer .contest {
	width: 170px;
}
.availableProposalsTableContainer .proposal {
	width: 300px;
}

.availableProposalsTableContainer .extra {
	width: 120px;
}

.availableProposalsTableContainer .action {
	width: 50px;
}
.availableProposalsTableContainer .prop-tabs {
	position: relative;
}
.filterProposalsBox {
	position: relative;
	float: right;
}
	
	</style>
</f:view>